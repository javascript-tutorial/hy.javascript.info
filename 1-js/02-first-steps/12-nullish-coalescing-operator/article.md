# Null֊ի միավորման (Nullish coalescing) օպերատոր '??'

[recent browser="new"]

Null֊ի միավորման օպերատորը գրվում է երկու հարցականի նշանի միջոցով՝ `??`։

Քանի որ այն վերաբերվում է `null` և `undefined` արժեքներին, մենք կօգտագործենք հատուկ տերմին այս հոդվածում։ Կասենք, որ արտահայտությունը "որոշված" է, եթե դրա արժեքը ո՛չ `null` է, ո՛չ `undefined`։

`a ?? b` արտահայտության արժեքը կլինի՝
- եթե `a`֊ն որոշված է, ապա `a`,
- եթե `a`֊ն որոշված չէ, ապա `b`։

Այլ կերպ ասած, `??` օպերատորը վերադարձնում է առաջին արգումենտը, եթե դրա արժեքը `null/undefined` չէ։ Հակառակ դեպքում՝ երկրորդը։

Null֊ի միավորման օպերատորը ամենևին նոր բան չէ, այն ուղղակի սիրուն գրելաձև է՝ երկու արժեքներից առաջին "որոշված" արժեքը ստանալու։

Կարող ենք գրել `result = a ?? b` արտահայտությունը օգտագործելով մեզ արդեն հայտնի օպերատորները․

```js
result = (a !== null && a !== undefined) ? a : b;
```

Հիմա արդեն պետք է պարզ լինի, թե ինչ է անում `??`֊ը։ Տեսնենք, թե որտեղ կարող է այն օգտակար լինել։

`??`֊ի հաճախ կիրառվում է պոտենցիալ չորոշված փոփոխականի փոխարեն լռելյայն (default) արժեք տալու համար:

Օրինակ, այստեղ ցուցադրում ենք `user`, եթե այն որոշված է, հակառակ դեպքում `Անանուն`․

```js run
let user;

alert(user ?? "Անանուն"); // Անանուն (user֊ը որոշված չէ)
```

Ահա օրինակ, երբ `user`֊ին վերագրված է անուն․

```js run
let user = "Ջոն";

alert(user ?? "Անանուն"); // Ջոն (user֊ը որոշված է)
```

Մենք կարող ենք նաև օգտագործել `??`֊ից կազմված շարան, առաջին ոչ `null/undefined` արժեքը վերցնելու համար։

Ենթադրենք ունենք օգտատիրոչ տվյալները հետևյալ փոփոխականների մեջ՝ `firstName`, `lastName`, `nickName`։ Դրանք բոլորը կարող են որոշված չլինել, եթե օգտատերը որոշի չմուտքագրել արժեք։

Մենք ցանկանում ենք ցուցադրել օգտատիրոջ անունը, օգտագործելով տրված փոփոխականներից մեկը, կամ ցուցադրել "Անանուն", եթե դրանցից ոչ մեկ որոշված չէ։

Օգտագործենք `??` օպերատորը․

```js run
let firstName = null;
let lastName = null;
let nickName = "Սուպերկոդեռ";

// ցուցադրում է առաջին որոշված արժեքը․
*!*
alert(firstName ?? lastName ?? nickName ?? "Անանուն"); // Սուպերկոդեռ
*/!*
```

## Համեմատում ||֊ի հետ

ԿԱՄ `||` օպերատորը կարող է օգտագործվել նույն կերպ ինչ `??`, որը նկարագրված է [նախորդ հոդվածում](info:logical-operators#or-finds-the-first-truthy-value)։

Օրինակ վերևի ծրագրում կարող ենք `??`֊ը փոխարինել `||`֊ով և ստանալ նույն արդյունքը․

```js run
let firstName = null;
let lastName = null;
let nickName = "Սուպերկոդեռ";

// ցուցադրում է առաջին որոշված արժեքը․
*!*
alert(firstName || lastName || nickName || "Անանուն"); // Սուպերկոդեռ
*/!*
```

ԿԱՄ `||` օպերատորը կար JavaScript֊ի ստեղծման պահից ի վեր, և ծրագրավորողները օգտագործում էին այն այսպիսի դեպքերի համար շատ երկար ժամանակ։

Իսկ null֊ի միավորման օպերատորը `??` ավելացվել է JavaScript֊ում վերջերս, և դրա պատճառը այն է, որ ծրագրավորողները այնքան էլ գոհ չէին `||`֊ից։

Կարևոր տարբերությունը դրանց միջև․
- `||`֊ը վերադարձնում է առաջին *ճշմարիտ* արժեքը։
- `??`֊ը վերադարձնում է առաջին *որոշված* արժեքը։

Այլ կերպ ասած, `||`֊ը  չի տարբերակում `false`, `0`, դատարկ տող `""` և `null/undefined` արժեքները։ Դրանք բոլորը նույնն են -- սխալական արժեքներ։ Եթե սրանցից ինչ֊որ մեկը լինի առաջին արգումենտ `||`֊ի համար, ապա մենք կստանանք երկրորդ արգումենտը արդյունքում։

Բայց պրակտիկայում լինում են դեպքեր երբ, մենք կարիք ենք ունենում օգտագործել լռելյայն արժեք միայն այն դեպքում, երբ փոփոխականը `null/undefined` է։ Դա այն դեպքն է, երբ արժեքը իրոք անհայտ է, կամ ոչ վերագրված։

Դիտարկենք հետևյալ օրինակը․

```js run
let height = 0;

alert(height || 100); // 100
alert(height ?? 100); // 0
```

- `height || 100` արտահայտությունը ստուգում է, արդյոք `height`֊ը սխալական է, թե ոչ։ Այն `0` է, որն էլ սխալական է,
    - այսպիսով `||`֊ի արդյունքը կլինի երկրորդ արգումենտը՝ `100`։
- `height ?? 100` արտահայտությունը ստուգում է, արդյոք `height`֊ը `null/undefined` է, թե ոչ, որն էլ այդպիսին չէ,
    - այսպիսով արդյունքը կլինի `height`, այսինքն `0`։

Պրակտիկայում զրոն վավեր (valid) արժեք է, որը չպետք է փոխարինվի լռելյայն արժեքով։ Այսինքն `??`֊ը անում է այն ինչ մեզ պետք է։

## Նախապատվություն

`??`֊ի նախապատվությունը գրեթե նույնն է ինչ `||`֊ինը։ Այն մի քիչ ցածր է՝ `5` [MDN աղյուսակում](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Operator_Precedence#Table), իսկ `||`֊ինը՝ `6`։

Դա նշանակում է, որ ինչպես `||`֊ի դեպքում, null֊ի միավորման օպերատոր `??`֊ը կատարվում է `=` և `?` օպերատորներից առաջ, բայց շատ այլ օպերատորնեից հետո, ինչպիսիք են `+`, `*`։

Այսպիսով, եթե մենք օգտագործում ենք `??`֊ը այլ օպերատորների հետ միասին մեկ արտահայտությունում՝ արժեք ընտրելու համար, պետք է նաև ավելացնել փակագծեր․

```js run
let height = null;
let width = null;

// կարևոր է օգտագործել փակագծեր
let area = (height ?? 100) * (width ?? 50);

alert(area); // 5000
```

Հակառակ դեպքում, եթե չդնենք փակագծերը, ապա, քանի որ `*`֊ի նախապատվությունը ավելի բարձր է քան `??`֊ինը, այն կաշխատի առաջինը, որի արդյունքում էլ կստանանք սխալ պատասխան։

```js
// առանց փակագծեր
let area = height ?? 100 * width ?? 50;

// ...աշխատում է ինչպես հետևյալը (որը այն չէ ինչ մենք ուզում ենք)․
let area = height ?? (100 * width) ?? 50;
```

### ??֊ի օգտագործումը && և ||֊ի հետ

Անվտանգության նկատառումներից ելնելով JavaScript֊ը արգելում է օգտագործել `??`֊ը `&&` և `||` օպերատորների հետ, բացառությամբ այն դեպքերի, երբ հստակ փակագծերով նշված է հերթականությունը։

Ներքևում գրված ծրագիրը կաշխատի սինտաքսի սխալով (syntax error)․

```js run
let x = 1 && 2 ?? 3; // Սինտաքսի սխալ
```

Այս սահմանափակումը ախոս քննարկման ենթակա է, այն ավելացվել է լեզվում, որպեսզի խուսափվեն ծրագրային սխալները, երբ ծրագրավորողը սկսում է անցում կատարել `||`֊ից `??`֊ին։

Օգտագործեք փակագծեր, որպեսզի այն աշխատի․

```js run
*!*
let x = (1 && 2) ?? 3; // Աշխատում է
*/!*

alert(x); // 2
```

## Ամփոփում

- Null֊ի միավորման օպերատոր `??`֊ը տրամադրում է կարճ ձև ընտրելու առաջին "որոշված" արժեքը շարքից։

    Օգտագործվում է փոփոխականին լռելյայն արժեք վերագրելու համար․

    ```js
    // դնում ենք height֊ի արժեքը 100, եթե height֊ը null կամ undefined է
    height = height ?? 100;
    ```

- `??` օպերատորը ունի շատ ցածր նախապատվության աստիճան, այն մի քիչ բարձր է, քան `?` և `=`֊ինը, այդ պատճառով կարևոր է հիշել ավելացնել փակագծեր, երբ այն օգտագործում ենք ինչ֊որ արտահայտության մեջ։
- Արգելված է օգտագործել այն `||` կամ `&&` օպերատորների հետ առանց փակագծերի։
